From 59904b284e3e537fd3350e43b528b5098abb9df0 Mon Sep 17 00:00:00 2001
From: Pietro Albini <pietro@pietroalbini.org>
Date: Fri, 31 Jan 2020 11:02:34 +0100
Subject: [PATCH 2/2] Runner.Listener: prevent self-updates

There is surely a better way to do this, but hey, this hack might be
enough.
---
 src/Runner.Listener/SelfUpdater.cs | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/src/Runner.Listener/SelfUpdater.cs b/src/Runner.Listener/SelfUpdater.cs
index 7b74a5d..0b13df9 100644
--- a/src/Runner.Listener/SelfUpdater.cs
+++ b/src/Runner.Listener/SelfUpdater.cs
@@ -62,6 +62,13 @@ namespace GitHub.Runner.Listener
 
                 Trace.Info($"An update is available.");
 
+                // disable self-updates
+                var rustAvoidUnreachableCodeError = true;
+                if (rustAvoidUnreachableCodeError) {
+                    Trace.Info("prevented self-update");
+                    return false;
+                }
+
                 // Print console line that warn user not shutdown runner.
                 await UpdateRunnerUpdateStateAsync("Runner update in progress, do not shutdown runner.");
                 await UpdateRunnerUpdateStateAsync($"Downloading {_targetPackage.Version} runner", $"RunnerPlatform: {_targetPackage.Platform}");
-- 
2.34.1

